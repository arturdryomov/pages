<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8"/>

  <title>Filling Android Autofill Gaps</title>
  <meta name="description" content="Google Smart Lock, Android Autofill, OpenYOLO, Google Credentials, passwords.txt — what else?"/>
  <meta name="author" content="Artur Dryomov"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="stylesheet" href="/css/syntax-highlighting.css"/>

  
  <meta name="theme-color" content="#1e2327">

  </head>

<body>

<header>
<nav>
  <ul>
    
    <li class="menu-left"><a href="/">Posts</a></li>
    
    
    <li class="menu-right"><a href="feed://arturdryomov.dev/index.xml">RSS</a></li>
    
    <li class="menu-right"><a href="https://github.com/arturdryomov">GitHub</a></li>
    
  </ul>
</nav>

</header>

<br/>


<div class="meta">

  <h1><span class="title">Filling Android Autofill Gaps</span></h1>
  <h3>February 13, 2019</h3>

</div>

<main>
<p>We can have different opinions but should be able to agree on one thing — we are humans.
Well, except ones who like <a href="https://www.gerritcodereview.com/">Gerrit</a>
and use <a href="https://en.wikipedia.org/wiki/Dashboard_(macOS)">Dashboard on macOS</a>.
Those are clearly aliens (Mulder was right).
All humans tend to forget things. Important and useless, smart and dumb, beautiful and ugly —
it does not matter, any thought or information can disappear.
Precious credentials for applications we work on are no exception.</p>
<p>Fortunately enough there are things serving as backup storage for the brain.
Like a password manager. Everybody should use one. We don’t use a single key
for all doors and leave it in the open, right? The digital world should be no different.</p>
<p>Enter Android. I’ve been following the password managing scene here for a while.
Honestly saying, it looks&hellip; Let’s say complicated. Google Smart Lock, Android Autofill,
Google Credentials, OpenYOLO. Which one should be used and when?
Let’s explore!</p>
<h1 id="options">Options</h1>
<h2 id="sharedpreferences"><code>SharedPreferences</code></h2>
<p>Technically it is possible to store credentials as plain text in <code>SharedPreferences</code>.
Even better — it can be synced across devices!
<a href="https://developer.android.com/reference/android/app/backup/SharedPreferencesBackupHelper"><code>SharedPreferencesBackupHelper</code></a>
was around since Android 2.2 and <a href="https://developer.android.com/guide/topics/data/keyvaluebackup">is well documented</a>.
Android 6.0 introduced <a href="https://developer.android.com/guide/topics/data/autobackup">automatic backups</a>
with minimal developer interaction.</p>
<p>Sounds good, but this is what we call in our business <em>a bad idea</em>.
<code>SharedPreferences</code> are not encrypted and can be read as-is with <code>root</code>
privileges. This is what I would call an analog to sticky notes with passwords
stitched to a monitor.</p>
<h2 id="google-smart-lock"><a href="https://developers.google.com/identity/smartlock-passwords/android/">Google Smart Lock</a></h2>
<p>This is the OG of the Google effort to streamline credentials storage.
It is obviously not new since it has the word <em>Smart</em> in the name.
Remember times when everything was named smart? Yeah, me neither kids.</p>
<p>It is bundled into Google Play Services and seems to be available on all recent platforms.
There is a nice dialog suggesting to store credentials in Google storage and
another one to pick credentials from an enumeration if there are multiple.
Even better — there is an option for an instant sign in if there is a single
credentials value. In this case, Google will show a banner informing a user about what happened.</p>
<p>The interaction is good from both sides. Users see a familiar Google branding
across applications, developers don’t need to implement interactions
over and over again.</p>
<p>The sweet part is the multi-platform availability.
Since credentials are stored by Google it becomes possible
to use the same credentials in Chrome. This is useful for services that have both
mobile and web presence.</p>
<p>The meh part is vendor lock-in. All passwords are stored at Google servers
and <a href="https://passwords.google.com/">can be viewed as plain text online</a>.
There are no sources stating how the data is stored and how secure the method is.
Not a lot of people hacked Google but technically there are no limitations.</p>
<h2 id="openyolo"><a href="https://github.com/openid/OpenYOLO-Android">OpenYOLO</a></h2>
<p>I’m not making this up, it is a real name. It stands for You Only Login Once.</p>
<p>It might seem like an SDK, but actually it is <a href="https://openid.net/specs/openyolo-android-ID1.html">a full-blown OpenID spec</a>.
The motivation behind it is solid — unify password managers under the same API and SPI,
making them interchangeable. Think about it as Smart Lock via any password manager.
Instead of Google the SDK will call a user-preferred application.</p>
<p>It went so well that password managers actually implemented it, including 1Password,
<a href="https://blog.dashlane.com/openyolo-password-managers-in-android-apps/">Dashlane</a>,
<a href="https://blog.lastpass.com/2017/11/introducing-lastpass-support-openyolo.html/">LastPass</a> and&hellip;
Google Smart Lock! Seems like there are no reasons to use Smart Lock directly, right?
There is a good abstraction on top of it to use user-installed applications instead.</p>
<p>Unfortunately, the project is half-dead. There are no updates for over a year,
<a href="https://www.linkedin.com/in/iainmcgin/">the tech lead no longer works at Google</a>
and something happened that ruined the adaptation completely. This thing is called&hellip;</p>
<h2 id="android-autofill"><a href="https://developer.android.com/guide/topics/text/autofill">Android Autofill</a></h2>
<p>The same year OpenYOLO was released and password managers boarded the ship,
Google decided to open a cannon fire and sink it. Autofill, introduced in Android Oreo,
solves basically the same issues as OpenYOLO. Users can change autofill providers —
including 1Password, Dashlane, LastPass and friends. The OS will ask the current provider
for credentials or will suggest storing them using the same provider.</p>
<p>Sounds like a good thing, but why do we need this when OpenYOLO was alive and well?
Why not use the spec under the hood of the autofill?
I have no idea what happened here. For an observer like me, it looks like a classic
<em>huge company too many teams</em> problem. Let’s take a look at the timeline.</p>
<ul>
<li>August 4, 2016. <a href="https://blog.dashlane.com/dashlane-google-open-source-api/">OpenYOLO initiative is announced</a>.</li>
<li>March 21, 2017. <a href="https://android-developers.googleblog.com/2017/03/first-preview-of-android-o.html">Android O is announced</a>.</li>
<li>May 3, 2017. <a href="https://openid.net/2017/05/03/public-review-period-for-openyolo-for-android-specification-started/">OpenYOLO OpenID draft is published</a>.</li>
<li>August 21, 2017. <a href="https://en.wikipedia.org/wiki/Android_Oreo">Android O is released</a>.</li>
<li>November 4, 2017. <a href="https://github.com/openid/OpenYOLO-Android/commit/ff0de4b8651354673a5e2dc97c1b78cf7c353651">OpenYOLO SDK contributions stopped</a>.</li>
</ul>
<p>Illuminati&hellip; confirmed?</p>
<p>Autofill is limited to Android version, OpenYOLO can be used anywhere.
Autofill is platform-specific, OpenYOLO is platform-agnostic.
And the cherry on top — it is possible to use them side-by-side but the experience
is confusing, it is like having both Smart Lock and OpenYOLO at the same time.
There are still no recommendations on what to prefer and when.
<a href="https://github.com/openid/OpenYOLO-Android/issues/127">The discussion about the dichotomy between Autofill and OpenYOLO</a>
stopped — guess when — October 2017.</p>
<p>I can feel the confusion of password manager developers who spent time
working on OpenYOLO then being informed that there is
a <a href="https://youtu.be/6uAmMfsfeAA?t=34">same-same but different</a> Autofill.</p>
<p>Don’t get me wrong — Autofill is a nice thing for users and developers.
It brings basically zero-effort password management —
mark an <code>EditText</code> with proper <code>inputType</code> or <code>autofillHints</code> and everything
will be done automagically, including filling and saving afterward.
It is just confusing to see it appear after OpenYOLO started to gain its momentum.</p>
<h2 id="google-credentials"><a href="https://developers.google.com/android/reference/com/google/android/gms/auth/api/credentials/package-summary">Google Credentials</a></h2>
<p>Don’t worry, this is not another SDK solving the same issues in its own way.
Its purpose is <a href="https://developers.google.com/identity/smartlock-passwords/android/retrieve-hints">to provide hints</a>
for sign in and sign up forms. There are pickers for accounts and phone numbers
which do not require additional system permissions to operate.</p>
<p>Requesting a phone number is obvious, but requesting a Google account will result
in an email address, a name, and even a photo URL! This is very useful
for sign up forms. Not sure about sign in ones though.</p>
<h1 id="decisions-decisions">Decisions, Decisions</h1>
<h2 id="sign-up">Sign Up</h2>
<p>Use Google Credentials all the time. From my experiments seems like
Autofill is able to fill the current device phone number but only
when Google is the Autofill provider. The same applies to emails and names.</p>
<h2 id="sign-in">Sign In</h2>
<ul>
<li>The application is targeting Oreo or higher.
Use Autofill, but be aware that not everyone sets up an Autofill provider.
It might be a good idea to collect usage analytics beforehand
using <a href="https://developer.android.com/reference/android/view/autofill/AutofillManager#getAutofillServiceComponentName()"><code>AutofillManager.autofillServiceComponentName</code></a>.</li>
<li>The application is not targeting Oreo.
Take a look at OpenYOLO, but honestly saying — it might be better to use
Smart Lock in terms of stability and support. Sad but true.</li>
</ul>
<p>Well, I guess it wasn’t hard to choose after all!
And now you have a good story to tell about OpenYOLO &#x1f609;</p>

</main>


<hr/>

<footer>
<nav>
  <ul>
    
    <li class="menu-left"><a href="/">Posts</a></li>
    
    
    <li class="menu-right"><a href="feed://arturdryomov.dev/index.xml">RSS</a></li>
    
    <li class="menu-right"><a href="https://github.com/arturdryomov">GitHub</a></li>
    
  </ul>
</nav>

</footer>


</body>

</html>

